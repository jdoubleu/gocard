privilegeTargets:

  'Neos\Flow\Security\Authorization\Privilege\Method\MethodPrivilege':
    'GoCardTeam.GoCardApi:UsersController.restrictedActions':
      matcher: 'method(GoCardTeam\GoCardApi\Controller\v1\Endpoint\UsersController->(?!(initialize)?(?i)(addUser))(.*)(?<!initialize)Action())'
    'GoCardTeam.GoCardApi:RegistersController.restrictedActions':
      matcher: 'method(GoCardTeam\GoCardApi\Controller\v1\Endpoint\RegistersController->.*Action())'
    'GoCardTeam.GoCardApi:CardsController.restrictedActions':
      matcher: 'method(GoCardTeam\GoCardApi\Controller\v1\Endpoint\CardsController->.*Action())'
    'GoCardTeam.GoCardApi:MembersController.restrictedActions':
      matcher: 'method(GoCardTeam\GoCardApi\Controller\v1\Endpoint\MembersController->.*Action())'
    'GoCardTeam.GoCardApi:ActivitiesController.restrictedActions':
      matcher: 'method(GoCardTeam\GoCardApi\Controller\v1\Endpoint\ActivitiesController->.*Action())'
    'GoCardTeam.GoCardApi:CardStatisticsController.restrictedActions':
      matcher: 'method(GoCardTeam\GoCardApi\Controller\v1\Endpoint\CardStatisticsController->.*Action())'
    'GoCardTeam.GoCardApi:UsersController.currentUser.getUserByEmail':
      matcher: 'method(GoCardTeam\GoCardApi\Controller\v1\Endpoint\UsersController->getUserByEmailAction(email != current.userContext.user.email))'
    'GoCardTeam.GoCardApi:UsersController.currentUser.getUserByIdAction':
      matcher: 'method(GoCardTeam\GoCardApi\Controller\v1\Endpoint\UsersController->getUserByIdAction(userId != current.userContext.user.uid))'
    'GoCardTeam.GoCardApi:UsersController.currentUser.editUserActions':
      matcher: 'method(GoCardTeam\GoCardApi\Controller\v1\Endpoint\UsersController->(update|delete)UserAction(user != current.userContext.user))'

roles:

  'Neos.Flow:AuthenticatedUser':
    privileges:
      -
        privilegeTarget: 'GoCardTeam.GoCardApi:UsersController.restrictedActions'
        permission: GRANT
      -
        privilegeTarget: 'GoCardTeam.GoCardApi:RegistersController.restrictedActions'
        permission: GRANT
      -
        privilegeTarget: 'GoCardTeam.GoCardApi:CardsController.restrictedActions'
        permission: GRANT
      -
        privilegeTarget: 'GoCardTeam.GoCardApi:MembersController.restrictedActions'
        permission: GRANT
      -
        privilegeTarget: 'GoCardTeam.GoCardApi:ActivitiesController.restrictedActions'
        permission: GRANT
      -
        privilegeTarget: 'GoCardTeam.GoCardApi:CardStatisticsController.restrictedActions'
        permission: GRANT
      -
        privilegeTarget: 'GoCardTeam.GoCardApi:UsersController.currentUser.getUserByEmail'
        permission: DENY
      -
        privilegeTarget: 'GoCardTeam.GoCardApi:UsersController.currentUser.getUserByIdAction'
        permission: DENY
      -
        privilegeTarget: 'GoCardTeam.GoCardApi:UsersController.currentUser.editUserActions'
        permission: DENY